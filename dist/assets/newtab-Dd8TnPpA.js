var Ke=Object.defineProperty;var Ye=(e,t,n)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var be=(e,t,n)=>Ye(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const f of i)if(f.type==="childList")for(const s of f.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const f={};return i.integrity&&(f.integrity=i.integrity),i.referrerPolicy&&(f.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?f.credentials="include":i.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(i){if(i.ep)return;i.ep=!0;const f=n(i);fetch(i.href,f)}})();function se(){}function Pe(e){return e()}function Ce(){return Object.create(null)}function J(e){e.forEach(Pe)}function Ne(e){return typeof e=="function"}function We(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let me;function Me(e,t){return e===t?!0:(me||(me=document.createElement("a")),me.href=t,e===me.href)}function Xe(e){return Object.keys(e).length===0}const Je=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function p(e,t){e.appendChild(t)}function Y(e,t,n){e.insertBefore(t,n||null)}function x(e){e.parentNode&&e.parentNode.removeChild(e)}function w(e){return document.createElement(e)}function ke(e){return document.createTextNode(e)}function R(){return ke(" ")}function F(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function Se(e){return function(t){return t.preventDefault(),e.call(this,t)}}function u(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ve(e){return Array.from(e.childNodes)}function Ee(e,t){t=""+t,e.data!==t&&(e.data=t)}function De(e,t,n,a){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Te(e,t,n){e.classList.toggle(t,!!n)}let ce;function le(e){ce=e}function Ze(){if(!ce)throw new Error("Function called outside component initialization");return ce}function Qe(e){Ze().$$.on_mount.push(e)}const ne=[],pe=[];let re=[];const Ae=[],et=Promise.resolve();let we=!1;function tt(){we||(we=!0,et.then(ze))}function Ie(e){re.push(e)}const ye=new Set;let te=0;function ze(){if(te!==0)return;const e=ce;do{try{for(;te<ne.length;){const t=ne[te];te++,le(t),nt(t.$$)}}catch(t){throw ne.length=0,te=0,t}for(le(null),ne.length=0,te=0;pe.length;)pe.pop()();for(let t=0;t<re.length;t+=1){const n=re[t];ye.has(n)||(ye.add(n),n())}re.length=0}while(ne.length);for(;Ae.length;)Ae.pop()();we=!1,ye.clear(),le(e)}function nt(e){if(e.fragment!==null){e.update(),J(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Ie)}}function rt(e){const t=[],n=[];re.forEach(a=>e.indexOf(a)===-1?t.push(a):n.push(a)),n.forEach(a=>a()),re=t}const ot=new Set;function je(e,t){e&&e.i&&(ot.delete(e),e.i(t))}function Re(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function at(e,t){e.d(1),t.delete(e.key)}function it(e,t,n,a,i,f,s,k,v,o,c,l){let h=e.length,b=f.length,m=h;const y={};for(;m--;)y[e[m].key]=m;const E=[],M=new Map,B=new Map,D=[];for(m=b;m--;){const g=l(i,f,m),I=n(g);let T=s.get(I);T?D.push(()=>T.p(g,t)):(T=o(I,g),T.c()),M.set(I,E[m]=T),I in y&&B.set(I,Math.abs(m-y[I]))}const N=new Set,z=new Set;function S(g){je(g,1),g.m(k,c),s.set(g.key,g),c=g.first,b--}for(;h&&b;){const g=E[b-1],I=e[h-1],T=g.key,U=I.key;g===I?(c=g.first,h--,b--):M.has(U)?!s.has(T)||N.has(T)?S(g):z.has(U)?h--:B.get(T)>B.get(U)?(z.add(T),S(g)):(N.add(U),h--):(v(I,s),h--)}for(;h--;){const g=e[h];M.has(g.key)||v(g,s)}for(;b;)S(E[b-1]);return J(D),E}function lt(e,t,n){const{fragment:a,after_update:i}=e.$$;a&&a.m(t,n),Ie(()=>{const f=e.$$.on_mount.map(Pe).filter(Ne);e.$$.on_destroy?e.$$.on_destroy.push(...f):J(f),e.$$.on_mount=[]}),i.forEach(Ie)}function st(e,t){const n=e.$$;n.fragment!==null&&(rt(n.after_update),J(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ct(e,t){e.$$.dirty[0]===-1&&(ne.push(e),tt(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function dt(e,t,n,a,i,f,s=null,k=[-1]){const v=ce;le(e);const o=e.$$={fragment:null,ctx:[],props:f,update:se,not_equal:i,bound:Ce(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(v?v.$$.context:[])),callbacks:Ce(),dirty:k,skip_bound:!1,root:t.target||v.$$.root};s&&s(o.root);let c=!1;if(o.ctx=n?n(e,t.props||{},(l,h,...b)=>{const m=b.length?b[0]:h;return o.ctx&&i(o.ctx[l],o.ctx[l]=m)&&(!o.skip_bound&&o.bound[l]&&o.bound[l](m),c&&ct(e,l)),h}):[],o.update(),c=!0,J(o.before_update),o.fragment=a?a(o.ctx):!1,t.target){if(t.hydrate){const l=Ve(t.target);o.fragment&&o.fragment.l(l),l.forEach(x)}else o.fragment&&o.fragment.c();t.intro&&je(e.$$.fragment),lt(e,t.target,t.anchor),ze()}le(v)}class ut{constructor(){be(this,"$$");be(this,"$$set")}$destroy(){st(this,1),this.$destroy=se}$on(t,n){if(!Ne(n))return se;const a=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return a.push(n),()=>{const i=a.indexOf(n);i!==-1&&a.splice(i,1)}}$set(t){this.$$set&&!Xe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ft="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ft);const{Map:ht}=Je;function Ue(e,t,n){const a=e.slice();return a[46]=t[n],a}function mt(e){let t,n,a,i;function f(){return e[19](e[46])}return{c(){t=w("img"),Me(t.src,n=`chrome://favicon/size/${Fe}@2x/${encodeURIComponent(e[46].url)}`)||u(t,"src",n),u(t,"alt",""),u(t,"loading","lazy")},m(s,k){Y(s,t,k),a||(i=F(t,"error",f),a=!0)},p(s,k){e=s,k[0]&4&&!Me(t.src,n=`chrome://favicon/size/${Fe}@2x/${encodeURIComponent(e[46].url)}`)&&u(t,"src",n)},d(s){s&&x(t),a=!1,i()}}}function gt(e){let t=e[46].initials+"",n;return{c(){n=ke(t)},m(a,i){Y(a,n,i)},p(a,i){i[0]&4&&t!==(t=a[46].initials+"")&&Ee(n,t)},d(a){a&&x(n)}}}function Oe(e,t){let n,a,i,f,s,k,v=t[46].displayTitle+"",o,c,l,h,b,m,y;function E(g,I){return g[46].fallback?gt:mt}let M=E(t),B=M(t);function D(...g){return t[20](t[46],...g)}function N(...g){return t[21](t[46],...g)}function z(...g){return t[22](t[46],...g)}function S(...g){return t[23](t[46],...g)}return{key:e,first:null,c(){n=w("article"),a=w("a"),i=w("div"),B.c(),s=R(),k=w("div"),o=ke(v),h=R(),b=w("button"),b.textContent="×",u(i,"class","tile-icon"),u(i,"style",f=`--dial-color: ${t[46].palette.background}; --dial-text: ${t[46].palette.text};`),u(i,"aria-hidden","true"),u(k,"class","tile-title"),u(a,"class","tile-link"),u(a,"href",c=t[46].url),u(a,"title",l=t[46].title||t[46].url),u(a,"draggable","false"),u(b,"class","remove-button"),u(b,"type","button"),u(b,"aria-label","Remove bookmark"),u(n,"class","tile"),u(n,"draggable","true"),this.first=n},m(g,I){Y(g,n,I),p(n,a),p(a,i),B.m(i,null),p(a,s),p(a,k),p(k,o),p(n,h),p(n,b),m||(y=[F(b,"click",D),F(n,"dragstart",N),F(n,"dragend",t[10]),F(n,"dragover",z),F(n,"drop",S)],m=!0)},p(g,I){t=g,M===(M=E(t))&&B?B.p(t,I):(B.d(1),B=M(t),B&&(B.c(),B.m(i,null))),I[0]&4&&f!==(f=`--dial-color: ${t[46].palette.background}; --dial-text: ${t[46].palette.text};`)&&u(i,"style",f),I[0]&4&&v!==(v=t[46].displayTitle+"")&&Ee(o,v),I[0]&4&&c!==(c=t[46].url)&&u(a,"href",c),I[0]&4&&l!==(l=t[46].title||t[46].url)&&u(a,"title",l)},d(g){g&&x(n),B.d(),m=!1,J(y)}}}function pt(e){let t,n,a,i,f,s,k,v,o,c,l,h=[],b=new ht,m,y,E,M,B,D,N,z,S,g,I,T,U,oe,V,ae,O,j,de,Z,ue,q,fe,W,ie,Q,A=Re(e[2]);const he=_=>_[46].id;for(let _=0;_<A.length;_+=1){let $=Ue(e,A,_),G=he($);b.set(G,h[_]=Oe(G,$))}return{c(){t=w("div"),n=R(),a=w("div"),i=w("button"),i.innerHTML='<img src="/icons/pencil.svg" alt=""/>',f=R(),s=w("main"),k=w("section"),v=ke(e[0]),c=R(),l=w("section");for(let _=0;_<h.length;_+=1)h[_].c();m=R(),y=w("article"),E=w("button"),E.innerHTML='<span aria-hidden="true">+</span> <div>Add shortcut</div>',M=R(),B=w("dialog"),D=w("form"),N=w("header"),N.innerHTML="<h2>Custom background</h2>",z=R(),S=w("div"),g=w("label"),I=w("span"),I.textContent="Choose an image (JPEG/PNG, up to 4 MB)",T=R(),U=w("input"),oe=R(),V=w("p"),V.textContent="The selected image is stored locally on this device only.",ae=R(),O=w("footer"),j=w("button"),j.textContent="Remove",de=R(),Z=w("span"),ue=R(),q=w("button"),q.textContent="Cancel",fe=R(),W=w("button"),W.textContent="Save",u(t,"id","background-layer"),Te(t,"visible",!!e[3]),De(t,"background-image",e[3]?`url(${e[3]})`:null),u(i,"class","icon-button"),u(i,"type","button"),u(i,"title","Change background"),u(i,"aria-label","Change background"),u(k,"id","status"),u(k,"role","status"),u(k,"aria-live","polite"),u(k,"data-tone",o=e[0]?e[1]:null),u(E,"class","add-button"),u(E,"type","button"),u(y,"class","tile add-tile"),u(y,"draggable","false"),u(l,"id","dial-grid"),u(l,"class","grid"),u(l,"aria-label","Bookmarked Dial links"),u(a,"class","page"),u(U,"type","file"),u(U,"accept","image/png,image/jpeg,image/jpg"),u(g,"class","file-picker"),u(V,"class","hint"),u(S,"class","dialog-body"),u(j,"type","button"),u(j,"id","clear-background"),u(j,"class","ghost-button"),u(Z,"class","spacer"),u(q,"type","button"),u(q,"id","cancel-background"),u(W,"type","submit"),u(W,"id","save-background"),u(O,"class","dialog-footer"),u(D,"id","background-form"),u(D,"method","dialog")},m(_,$){Y(_,t,$),Y(_,n,$),Y(_,a,$),p(a,i),p(a,f),p(a,s),p(s,k),p(k,v),p(s,c),p(s,l);for(let G=0;G<h.length;G+=1)h[G]&&h[G].m(l,null);p(l,m),p(l,y),p(y,E),Y(_,M,$),Y(_,B,$),p(B,D),p(D,N),p(D,z),p(D,S),p(S,g),p(g,I),p(g,T),p(g,U),e[24](U),p(S,oe),p(S,V),p(D,ae),p(D,O),p(O,j),p(O,de),p(O,Z),p(O,ue),p(O,q),p(O,fe),p(O,W),e[25](B),ie||(Q=[F(i,"click",e[15]),F(E,"click",e[7]),F(l,"dragover",e[13]),F(l,"drop",e[14]),F(j,"click",Se(e[17])),F(q,"click",Se(e[18])),F(D,"submit",e[16])],ie=!0)},p(_,$){$[0]&8&&Te(t,"visible",!!_[3]),$[0]&8&&De(t,"background-image",_[3]?`url(${_[3]})`:null),$[0]&1&&Ee(v,_[0]),$[0]&3&&o!==(o=_[0]?_[1]:null)&&u(k,"data-tone",o),$[0]&8004&&(A=Re(_[2]),h=it(h,$,he,1,_,A,b,l,at,Oe,m,Ue))},i:se,o:se,d(_){_&&(x(t),x(n),x(a),x(M),x(B));for(let $=0;$<h.length;$+=1)h[$].d();e[24](null),e[25](null),ie=!1,J(Q)}}}const Fe=64,ge="customBackgroundImage";function kt(e,t){const n=e.getBoundingClientRect(),a=n.width>=n.height,i=a?n.width/2:n.height/2,s=(a?t.clientX-n.left:t.clientY-n.top)<i;e.classList.toggle("drop-before",s),e.classList.toggle("drop-after",!s)}function _e(){document.querySelectorAll(".tile.drop-before, .tile.drop-after").forEach(e=>{e.classList.remove("drop-before","drop-after")})}function bt(e,t,n,a){const i=e.getBoundingClientRect(),f=i.width>=i.height,s=f?i.width/2:i.height/2,v=(f?t.clientX-i.left:t.clientY-i.top)>=s;let o=n+(v?1:0);return a<o&&v&&(o-=1),o}function yt(e){try{return new URL(e).href}catch{try{return new URL(`https://${e}`).href}catch{return null}}}function _t(e){try{return new URL(e).hostname.replace(/^www\./i,"")}catch{return e}}function vt(e){return e?e.trim().split(/\s+/)[0].slice(0,2).toUpperCase():"•"}function wt(e,t){let n;return(...a)=>{clearTimeout(n),n=setTimeout(()=>e(...a),t)}}function It(e){const t=(e||"").trim().toLowerCase();if(!t)return{background:"linear-gradient(145deg, #fde68a, #fbbf24)",text:"rgba(15, 23, 42, 0.85)"};let n=0,a=0,i=0;for(let y=0;y<t.length;y++){const E=t.charCodeAt(y),M=y+1;n+=E*M,a+=E*(M+1.5),i+=E*(M+2.5)}const f=ve(n,360),s=ve(a,36)-18,k=ve(f+24+s,360),v=52+Math.abs(a)%30,o=42+Math.abs(i)%20,c=Math.min(96,v+8),l=Math.min(78,o+12),h=`hsl(${f}, ${v}%, ${o}%)`,b=`hsl(${k}, ${c}%, ${l}%)`,m=o>54?"rgba(30, 41, 59, 0.85)":"rgba(255, 255, 255, 0.88)";return{background:`linear-gradient(140deg, ${h}, ${b})`,text:m}}function ve(e,t){return(e%t+t)%t}function Et(e,t){return new Promise((n,a)=>{if(e.size>t){a(new Error("File exceeds size limit"));return}const i=new FileReader;i.onload=()=>n(i.result),i.onerror=()=>a(i.error||new Error("Failed to read file")),i.readAsDataURL(e)})}function Bt(){console.info("Bookmarked Dial: using mock Chrome APIs for development");let e="mock-folder",t=0;const n={onCreated:new Set,onChanged:new Set,onMoved:new Set,onRemoved:new Set,onImportBegan:new Set,onImportEnded:new Set},a=new Map,i=new Map([["speedDialFolderId",e]]),f=[{id:"mock-1",parentId:e,title:"Svelte",url:"https://svelte.dev",index:0},{id:"mock-2",parentId:e,title:"MDN Web Docs",url:"https://developer.mozilla.org",index:1}];function s(o,...c){n[o].forEach(l=>{try{l(...c)}catch(h){console.error(`Mock chrome ${o} handler failed`,h)}})}function k(o){const c=n[o];return{addListener:l=>c.add(l),removeListener:l=>c.delete(l)}}function v(){return e}return{runtime:{sendMessage:async o=>(o==null?void 0:o.type)==="getFolderId"?{folderId:v()}:(o==null?void 0:o.type)==="resetFolderCache"?(e="mock-folder",i.set("speedDialFolderId",e),{folderId:e}):{}},bookmarks:{onCreated:k("onCreated"),onChanged:k("onChanged"),onMoved:k("onMoved"),onRemoved:k("onRemoved"),onImportBegan:k("onImportBegan"),onImportEnded:k("onImportEnded"),async getChildren(o){return f.filter(c=>c.parentId===o).sort((c,l)=>c.index-l.index)},async create({parentId:o,title:c,url:l}){const h=`mock-${Date.now()}-${t++}`,b={id:h,parentId:o,title:c,url:l,index:f.filter(m=>m.parentId===o).length};return f.push(b),s("onCreated",h,b),b},async remove(o){const c=f.findIndex(h=>h.id===o);if(c===-1)throw new Error("Bookmark not found");const[l]=f.splice(c,1);s("onRemoved",o,{parentId:l.parentId,node:l})},async move(o,{parentId:c,index:l}){const h=f.findIndex(y=>y.id===o);if(h===-1)throw new Error("Bookmark not found");const[b]=f.splice(h,1);b.parentId=c;const m=f.filter(y=>y.parentId===c);return m.splice(l,0,b),m.forEach((y,E)=>{y.index=E}),s("onMoved",o,{parentId:c}),b}},storage:{local:{async get(o){if(Array.isArray(o)){const c={};return o.forEach(l=>c[l]=a.get(l)),c}if(typeof o=="object"){const c={...o};for(const l of Object.keys(o))a.has(l)&&(c[l]=a.get(l));return c}return{[o]:a.get(o)}},async set(o){Object.entries(o).forEach(([c,l])=>a.set(c,l))},async remove(o){Array.isArray(o)?o.forEach(c=>a.delete(c)):a.delete(o)}},sync:{async get(o){if(Array.isArray(o)){const c={};return o.forEach(l=>c[l]=i.get(l)),c}if(typeof o=="object"){const c={...o};for(const l of Object.keys(o))i.has(l)&&(c[l]=i.get(l));return c}return{[o]:i.get(o)}},async set(o){Object.entries(o).forEach(([c,l])=>i.set(c,l))},async remove(o){Array.isArray(o)?o.forEach(c=>i.delete(c)):i.delete(o)}}}}}function Lt(e,t,n){var Be;const a={loading:"Loading Bookmarked Dial…",empty:"No bookmarks yet. Add shortcuts from this page or the bookmark manager.",error:"Bookmarked Dial folder is unavailable. Try reopening the tab or reinstalling the extension."},i=4*1024*1024,f=typeof chrome<"u"?chrome:null,s=(Be=f==null?void 0:f.runtime)!=null&&Be.sendMessage?f:Bt();let k=a.loading,v="info",o=[],c=new Set,l=null,h=null,b="",m,y;const E=[];Qe(()=>(B(),ie(),M(),()=>{E.forEach(r=>r==null?void 0:r())}));async function M(){try{l=await D(),N(),await S()}catch(r){console.error("Bookmarked Dial: initialization failed",r),A(a.error,"error")}}function B(){if(typeof window>"u"||typeof window.matchMedia!="function")return;const r=window.matchMedia("(prefers-color-scheme: dark)");document.body.classList.toggle("dark",r.matches);const d=L=>{document.body.classList.toggle("dark",L.matches)};r.addEventListener("change",d),E.push(()=>r.removeEventListener("change",d))}async function D(){const r=await s.runtime.sendMessage({type:"getFolderId"});if(!(r!=null&&r.folderId))throw new Error((r==null?void 0:r.error)||"Missing folder");return r.folderId}function N(){var Le,$e;const r=wt(S,150),d=(P,K)=>{K.parentId===l&&r()};s.bookmarks.onCreated.addListener(d);const L=P=>{c.has(P)&&r()};s.bookmarks.onChanged.addListener(L);const C=(P,K)=>{(K.parentId===l||c.has(P))&&r()};s.bookmarks.onMoved.addListener(C);const X=(P,K)=>{K.parentId===l||c.has(P)?(c.delete(P),r()):P===l&&z()};s.bookmarks.onRemoved.addListener(X);const ee=()=>r(),H=()=>A("Importing bookmarks…");(Le=s.bookmarks.onImportEnded)==null||Le.addListener(ee),($e=s.bookmarks.onImportBegan)==null||$e.addListener(H),E.push(()=>{var P,K;s.bookmarks.onCreated.removeListener(d),s.bookmarks.onChanged.removeListener(L),s.bookmarks.onMoved.removeListener(C),s.bookmarks.onRemoved.removeListener(X),(P=s.bookmarks.onImportEnded)==null||P.removeListener(ee),(K=s.bookmarks.onImportBegan)==null||K.removeListener(H)})}async function z(){A("Bookmarked Dial folder was removed. Recreating…");try{const r=await s.runtime.sendMessage({type:"resetFolderCache"});if(r!=null&&r.folderId)l=r.folderId,await S(),A("Bookmarked Dial folder restored.","success");else throw new Error((r==null?void 0:r.error)||"Unable to recreate folder")}catch(r){console.error("Bookmarked Dial: missing folder recovery failed",r),A(a.error,"error")}}async function S(){if(l)try{const d=(await s.bookmarks.getChildren(l)).filter(L=>!!L.url);g(d),d.length===0?A(a.empty):A("","info")}catch(r){console.error("Bookmarked Dial: failed to load bookmarks",r),A(a.error,"error")}}function g(r){c=new Set(r.map(d=>d.id)),n(2,o=r.map(d=>({...d,displayTitle:d.title||d.url,initials:vt(d.title||d.url),palette:It(d.title||d.url),fallback:!1})))}function I(r){const d=o.findIndex(C=>C.id===r);if(d===-1)return;const L=[...o];L[d]={...L[d],fallback:!0},n(2,o=L)}async function T(){const r=prompt("Enter the URL for the new shortcut:");if(!r)return;const d=yt(r.trim());if(!d){alert("That does not appear to be a valid URL.");return}const L=_t(d),C=prompt("Enter a title for the shortcut:",L),X=C?C.trim():L;try{await s.bookmarks.create({parentId:l,title:X,url:d})}catch(ee){console.error("Bookmarked Dial: failed to create bookmark",ee),alert("Unable to add shortcut. Please try again.")}}async function U(r){if(confirm("Remove this shortcut?"))try{await s.bookmarks.remove(r)}catch(d){console.error("Bookmarked Dial: failed to remove bookmark",d),alert("Unable to remove shortcut.")}}function oe(r,d){h=d.id,r.dataTransfer.effectAllowed="move",r.dataTransfer.setData("text/plain",d.id),requestAnimationFrame(()=>{r.currentTarget.classList.add("dragging")})}function V(r){h=null,r.currentTarget.classList.remove("dragging"),_e()}function ae(r,d){h&&(r.preventDefault(),r.dataTransfer.dropEffect="move",kt(r.currentTarget,r))}function O(r,d){r.preventDefault(),_e();const L=h||r.dataTransfer.getData("text/plain");if(!L||L===d.id)return;const C=o.findIndex(H=>H.id===L),X=o.findIndex(H=>H.id===d.id);if(C===-1||X===-1)return;const ee=bt(r.currentTarget,r,X,C);Z(L,ee).catch(H=>{console.error("Bookmarked Dial: failed to reorder bookmark",H),A("Reorder failed. Try again.","error"),S()})}function j(r){h&&(r.preventDefault(),r.dataTransfer.dropEffect="move")}function de(r){if(!h)return;r.preventDefault(),_e();const d=h||r.dataTransfer.getData("text/plain");o.findIndex(C=>C.id===d)!==-1&&Z(d,o.length).catch(C=>{console.error("Bookmarked Dial: failed to move bookmark to end",C),A("Reorder failed. Try again.","error"),S()})}async function Z(r,d){await s.bookmarks.move(r,{parentId:l,index:d})}function ue(){y&&n(5,y.value="",y),m==null||m.showModal()}async function q(r){var L;r.preventDefault();const d=(L=y==null?void 0:y.files)==null?void 0:L[0];if(!d){m==null||m.close();return}if(!he(d)){alert("Please choose a JPEG or PNG image under 4 MB.");return}try{const C=await Et(d,i);await s.storage.local.set({[ge]:C}),Q(C),m==null||m.close()}catch(C){console.error("Bookmarked Dial: failed to save background",C),alert("Unable to store the background image. Try a smaller file.")}}async function fe(){await s.storage.local.remove(ge),Q(null),m==null||m.close()}function W(){m==null||m.close()}async function ie(){try{const r=await s.storage.local.get(ge);Q(r[ge])}catch(r){console.error("Bookmarked Dial: failed to load background",r)}}function Q(r){n(3,b=r||"")}function A(r,d="info"){n(0,k=r),n(1,v=d)}function he(r){return["image/jpeg","image/png"].includes(r.type)&&r.size<=i}const _=r=>I(r.id),$=(r,d)=>{d.preventDefault(),d.stopPropagation(),U(r.id)},G=(r,d)=>oe(d,r),Ge=(r,d)=>ae(d),xe=(r,d)=>O(d,r);function qe(r){pe[r?"unshift":"push"](()=>{y=r,n(5,y)})}function He(r){pe[r?"unshift":"push"](()=>{m=r,n(4,m)})}return[k,v,o,b,m,y,I,T,U,oe,V,ae,O,j,de,ue,q,fe,W,_,$,G,Ge,xe,qe,He]}class $t extends ut{constructor(t){super(),dt(this,t,Lt,pt,We,{},null,[-1,-1])}}new $t({target:document.getElementById("app")});
